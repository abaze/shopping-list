(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{226:function(t,e,r){var content=r(228);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(31).default)("75643320",content,!0,{sourceMap:!1})},227:function(t,e,r){"use strict";var o=r(226);r.n(o).a},228:function(t,e,r){(e=r(30)(!1)).push([t.i,".label-icon{font-size:.7rem}",""]),t.exports=e},231:function(t,e,r){"use strict";r.r(e);var o={props:["show"]},n=(r(227),r(24)),component=Object(n.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return this.show?e("div",[e("span",{staticClass:"text-center text-color-primary"},[e("b-iconstack",{attrs:{"font-scale":"3",animation:"cylon"}},[e("b-icon",{attrs:{stacked:"",icon:"cart4",animation:"cylon",variant:"color-primary"}})],1),this._v(" "),e("p",{staticClass:"label-icon"},[this._v("Chargement...")])],1)]):this._e()}),[],!1,null,null,null);e.default=component.exports},238:function(t,e,r){var content=r(398);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(31).default)("071d09c9",content,!0,{sourceMap:!1})},245:function(t,e,r){"use strict";r.r(e);var o={props:["show"]},n=r(24),component=Object(n.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("b-overlay",{attrs:{fixed:"","no-wrap":"",show:this.show},scopedSlots:this._u([{key:"overlay",fn:function(){return[e("div",{staticClass:"text-center"},[e("loader",{attrs:{show:!0}})],1)]},proxy:!0}])})],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Loader:r(231).default})},397:function(t,e,r){"use strict";var o=r(238);r.n(o).a},398:function(t,e,r){(e=r(30)(!1)).push([t.i,".progress-bar[data-v-a7d9ba38]{overflow:visible;overflow:initial}",""]),t.exports=e},418:function(t,e,r){"use strict";r.r(e);r(5),r(2),r(3),r(1),r(4),r(63),r(83),r(84);var o=r(0),n=r(44);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function l(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var d={middleware:"auth",data:function(){return{ready_product_line:!0,show_list_products:!1,form:{dateCourse:null,budget_max:null},total_facture_ht:0,total_quantity:0,animatedTTC:0,animatedRestant:0,show_save_overlay:!1,show_recap:!1,id_recap:null}},head:function(){return{title:"Composez votre liste de course tout en surveillant votre budget",script:[{src:"https://cdnjs.cloudflare.com/ajax/libs/gsap/3.2.4/gsap.min.js"}]}},computed:l(l({},Object(n.b)({categories:function(t){return t.categories},user:function(t){return t.user},panier:function(t){return t.panier},all_listes:function(t){return t.all_listes}})),{},{datesListes:function(){if(this.all_listes)return this.all_listes.map((function(t){return t.date}))},state_date:function(){return this.form.dateCourse?!this.datesListes.includes(this.form.dateCourse):null},total_facture_ttc:function(){if(this.total_facture_ht)return this.total_facture_ht>0?parseFloat(1.196*this.total_facture_ht).toFixed(2):0},total_restant_depense:function(){if(this.form.budget_max&&this.total_facture_ttc)return parseFloat(this.form.budget_max-this.total_facture_ttc).toFixed(2)},status_color:function(){var t=parseInt(this.form.budget_max/2);return this.total_restant_depense>=t?"success":this.total_restant_depense<=0?"danger":"warning"}}),watch:{"panier.produits":function(t){var e=this;if(t){var r=0,o=0;t.forEach((function(t){t.produits.forEach((function(p){var t=e.$store.state.all_products.find((function(article){return article.id===p.id})).price;r+=parseFloat(t*parseInt(p.quantity)),o+=parseInt(p.quantity)}))})),this.total_facture_ht=r,this.$store.commit("GLOBAL_DATA_PANIER",{date:this.form.dateCourse,count_produits:o,price:this.total_facture_ttc,budget:this.form.budget_max,user:this.user.id})}},"form.budget_max":function(t){var input=document.querySelector("#budgetMax"),e=this;setTimeout((function(){input.blur(),e.show_list_products=!!t}),1e3)},total_facture_ttc:function(t){this.animateNumber({val:t,targetVar:"animatedTTC"})},total_restant_depense:function(t){this.animateNumber({val:t,targetVar:"animatedRestant"})}},methods:{dateDisabled:function(t,e){return e<new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())},listExist:function(t,e){return this.datesListes.includes(t)?"bg-warning disable":""},maj_product:function(t){0==this.panier.length||0==this.panier.filter((function(e){return e.id_cat==t.id_cat})).length?this.panier.push(t):this.panier.forEach((function(e){e.id_cat==t.id_cat&&(e=t)}))},saveListe:function(){var t=this,e=this;this.show_save_overlay=!0;var r=this.panier;this.$axios.post("/listes",{date:r.date,price:r.price,budget:r.budget,count_produits:r.count_produits,produits:r.produits,user:r.user},{headers:{Authorization:"Bearer ".concat(this.user.jwt)}}).then((function(r){t.$store.dispatch("ADD_STATS").then((function(t){e.id_recap=r.data.id,e.show_save_overlay=!1,e.show_recap=!0,e.$store.commit("RESET_PANIER"),e.form.dateCourse=null,e.ready_product_line=!1}))}))},animateNumber:function(t){var e=t.val,r=t.duration,n=void 0===r?.5:r,c=t.targetVar;gsap.to(this.$data,Object(o.a)({duration:n},c,e))}},mounted:function(){this.$store.commit("RESET_PANIER"),this.ready_product_line=!0},beforeDestroy:function(){Object.assign(this.$data,this.$options.data()),this.$store.commit("RESET_PANIER")}},_=(r(397),r(24)),component=Object(_.a)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("overlay-load",{attrs:{show:t.show_save_overlay}}),t._v(" "),t.show_recap?r("div",[r("b-row",[r("b-col",[r("span",{staticClass:"h3"},[t._v("Votre commande a été sauvegardée avec succès !")]),t._v(" "),r("hr")])],1),t._v(" "),r("recap-liste",{attrs:{id:t.id_recap}})],1):r("div",[r("h1",[t._v("Créez votre liste de course")]),t._v(" "),r("b-form",[r("b-form-group",{staticClass:"animate__animated animate__fadeInRight position-relative",staticStyle:{"z-index":"1"},attrs:{label:"Pour quel jour ?",description:"A quelle date souhaitez-vous faire vos courses ?"}},[r("b-form-datepicker",{staticClass:"mb-2 w-25 min-w-300",attrs:{id:"example-datepicker","date-disabled-fn":t.dateDisabled,"aria-describedby":"input-live-date","date-info-fn":t.listExist,state:t.state_date,dropright:""},model:{value:t.form.dateCourse,callback:function(e){t.$set(t.form,"dateCourse",e)},expression:"form.dateCourse"}}),t._v(" "),r("b-form-invalid-feedback",{attrs:{id:"input-live-date"}},[t._v("\r\n            Il y a déjà des courses prévues à cette date\r\n          ")])],1),t._v(" "),t.form.dateCourse&&1==t.state_date?r("b-form-group",{staticClass:"animate__animated animate__fadeInRight",attrs:{label:"Votre limite de budget ?"}},[r("b-row",[r("b-col",{attrs:{sm:"6"}},[r("b-input-group",{staticClass:"w-25 min-w-300",attrs:{size:"lg",append:"€"}},[r("b-form-input",{attrs:{id:"budgetMax"},model:{value:t.form.budget_max,callback:function(e){t.$set(t.form,"budget_max",e)},expression:"form.budget_max"}})],1)],1),t._v(" "),t.total_facture_ttc>0?r("b-col",{staticClass:"h1 animate__animated animate__zoomIn min-w-300 text-right",class:"text-"+t.status_color},[t._v("\r\n              Total TTC :\r\n              "),r("strong",[t._v(t._s(parseFloat(t.animatedTTC).toFixed(2))+" €")])]):t._e()],1),t._v(" "),t.total_facture_ttc?r("b-progress",{staticClass:"animate__animated animate__fadeInLeft mt-2",attrs:{max:t.form.budget_max,height:"2rem",variant:t.status_color}},[r("b-progress-bar",{attrs:{value:t.total_restant_depense<0?0:t.total_restant_depense,striped:"",animated:""}},[r("span",["success"==t.status_color?r("strong",[r("b-iconstack",{staticClass:"align-middle mr-1",attrs:{"font-scale":"1.5"}},[r("b-icon",{attrs:{stacked:"",icon:"circle"}}),t._v(" "),r("b-icon",{attrs:{stacked:"",icon:"check"}})],1),t._v("\r\n                  Reste "+t._s(parseFloat(t.animatedRestant).toFixed(2))+" € à\r\n                  dépenser\r\n                ")],1):"warning"==t.status_color?r("strong",[r("b-icon",{staticClass:"align-middle mr-1",attrs:{icon:"exclamation-circle","font-scale":"1.5"}}),t._v("\r\n                  Reste "+t._s(parseFloat(t.animatedRestant).toFixed(2))+" € à\r\n                  dépenser\r\n                ")],1):r("strong",{staticClass:"text-danger"},[r("b-icon",{staticClass:"align-middle mr-1",attrs:{icon:"exclamation-triangle-fill",animation:"throb","font-scale":"1.5"}}),t._v("\r\n                  Vous dépassez votre budget de\r\n                  "+t._s(parseFloat(t.animatedRestant).toFixed(2))+" €\r\n                ")],1)])])],1):t._e()],1):t._e(),t._v(" "),t.show_list_products?r("b-form-group",{attrs:{label:"De quoi avez-vous besoin ?",description:"Remplissez chaque catégorie des produits dont vous avez besoin"}},[r("b-form-row",t._l(t.categories,(function(e,o){return r("b-col",{key:e.id,attrs:{cols:"12",xl:"6"}},[t.ready_product_line?r("add-products",{key:e.name,class:"animate__animated animate__bounceInRight animate__delay-"+o+"s",attrs:{categorie_id:e.id}}):t._e()],1)})),1)],1):t._e(),t._v(" "),t.total_facture_ttc>0?r("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-save",modifiers:{"modal-save":!0}}],staticClass:"w-100 animate__animated animate__fadeInRight",attrs:{size:"lg",variant:"color-primary"}},[t._v("Enregistrer ma liste")]):t._e(),t._v(" "),r("b-modal",{attrs:{id:"modal-save",title:"Confirmation"},on:{ok:t.saveListe}},[r("p",{staticClass:"my-4"},[t._v("Êtes-vous sûr de n'avoir rien oublié ?")])])],1)],1)],1)}),[],!1,null,"a7d9ba38",null);e.default=component.exports;installComponents(component,{OverlayLoad:r(245).default,AddProducts:r(386).default,RecapListe:r(233).default})}}]);